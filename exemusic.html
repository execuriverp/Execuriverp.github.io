<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>ExeMusicV1 - Music Player</title>

<!-- FAVICON -->
<link rel="icon" type="image/png" href="exemusicicon.png">

<style>
:root{
  --accent:#1db954;
  --accent2:#1ed760;
  --accent3:#10a745;
  --accent4:#14c953;
  --primary:#6b5fc7;
  --secondary:#ff006d;
  --danger:#ff1744;
  --text:#fff;
  --text-secondary:#b3b3b3;
  --text-muted:#787878;
  --card:#1a1a2e;
  --card-hover:#16213e;
  --card2:#282828;
  --bg:#0f0f0f;
  --bg-gradient:#0a0a0a;
  --success:#4ade80;
  --warning:#fbbf24;
}

/* RESET */
*{box-sizing:border-box;font-family:'Circular',system-ui,-apple-system,sans-serif}
html,body{
  margin:0;width:100%;height:100%;
  background:#000;color:#fff;overflow:hidden;
  -webkit-font-smoothing:antialiased;
}

/* BG */
.bg{
  position:fixed;inset:0;
  background:
    linear-gradient(135deg,rgba(29,185,84,0.2) 0%,rgba(107,95,199,0.15) 50%,rgba(255,0,109,0.1) 100%),
    radial-gradient(circle at 20% 20%,rgba(29,185,84,0.25),transparent 40%),
    radial-gradient(circle at 80% 80%,rgba(107,95,199,0.2),transparent 50%),
    #000;
  animation: bgShift 20s ease-in-out infinite;
}

@keyframes bgShift{
  0%,100%{filter:brightness(1)}
  50%{filter:brightness(1.05)}
}

/* APP */
.app{
  position:relative;z-index:1;
  height:100dvh;max-width:420px;
  margin:auto;padding:12px 12px 12px;
  display:flex;flex-direction:column;gap:6px;
  overflow-y:auto;
  scrollbar-width:thin;
  scrollbar-color:rgba(255,255,255,.1) transparent;
}

.app::-webkit-scrollbar{width:6px}
.app::-webkit-scrollbar-track{background:transparent}
.app::-webkit-scrollbar-thumb{background:rgba(255,255,255,.1);border-radius:3px}
.app::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.2)}

/* HEADER */
.header{
  display:flex;
  align-items:center;
  justify-content:center;
  padding:6px 0 2px;
  gap:10px;
  flex-wrap:wrap;
}
.header img{
  width:160px;
  max-width:70vw;
  height:auto;
  object-fit:contain;
  filter:drop-shadow(0 4px 16px rgba(29,185,84,.5));
  animation:float 3s ease-in-out infinite;
}

@keyframes float{
  0%,100%{transform:translateY(0px)}
  50%{transform:translateY(-8px)}
}

.header-badge{
  background:linear-gradient(135deg,#1db954,#1ed760);
  padding:4px 10px;
  border-radius:20px;
  font-size:10px;
  font-weight:700;
  color:#000;
  box-shadow:0 2px 8px rgba(29,185,84,.4);
}

/* VERSION */
.version{
  text-align:center;
  font-size:11px;
  color:var(--text-muted);
  margin:-2px 0 6px;
  opacity:0.8;
  letter-spacing:0.5px;
  background:rgba(29,185,84,0.1);
  padding:4px 8px;
  border-radius:10px;
  width:fit-content;
  margin-left:auto;
  margin-right:auto;
}

/* COVER */
.cover{
  height:35dvh;
  border-radius:16px;
  background:linear-gradient(135deg,var(--accent) 0%,var(--accent2) 50%,#0f6b3b 100%);
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 12px 32px rgba(29,185,84,.3),inset 0 0 20px rgba(255,255,255,.1);
  margin:8px 0 12px;
  position:relative;
  overflow:hidden;
}

.cover::before{
  content:'';
  position:absolute;
  inset:0;
  background:radial-gradient(circle at 30% 30%,rgba(255,255,255,.2),transparent 60%);
}

.cover::after{
  content:'';
  position:absolute;
  inset:0;
  background:radial-gradient(circle at 70% 70%,rgba(0,0,0,.1),transparent 50%);
}

.eq{display:flex;gap:6px;height:60px;align-items:flex-end;position:relative;z-index:1}
.eq span{
  width:6px;background:rgba(0,0,0,.9);border-radius:3px;box-shadow:0 2px 8px rgba(0,0,0,.4);
  animation:eq .6s infinite ease-in-out paused;
}
.eq span:nth-child(1){animation-delay:0s;height:24px}
.eq span:nth-child(2){animation-delay:.1s;height:40px}
.eq span:nth-child(3){animation-delay:.2s;height:32px}
.eq span:nth-child(4){animation-delay:.3s;height:28px}
.eq span:nth-child(5){animation-delay:.2s;height:36px}

@keyframes eq{0%,100%{transform:scaleY(0.2)}50%{transform:scaleY(1)}}

/* META */
.title{
  text-align:center;
  font-size:24px;
  font-weight:800;
  margin:6px 0 2px;
  line-height:1.2;
  letter-spacing:-0.5px;
  background:linear-gradient(135deg,#fff 0%,#b3b3b3 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
.by{
  text-align:center;
  font-size:13px;
  color:var(--text-secondary);
  margin-bottom:10px;
  font-weight:500;
  opacity:0.9;
}

/* URL + COPY */
.url-wrap{
  display:flex;gap:8px;justify-content:center;align-items:center;
  padding:10px 12px;
  background:linear-gradient(135deg,rgba(29,185,84,0.1) 0%,rgba(107,95,199,0.1) 100%);
  border:1px solid rgba(29,185,84,0.3);
  border-radius:10px;
  margin:6px 0 8px;
  transition:all .3s;
}

.url-wrap:hover{
  background:linear-gradient(135deg,rgba(29,185,84,0.15) 0%,rgba(107,95,199,0.15) 100%);
  border-color:rgba(29,185,84,0.5);
}

.url{
  font-size:11px;
  color:#4ade80;
  word-break:break-all;
  max-width:85%;
  font-family:monospace;
  font-weight:600;
}
.copy-btn{
  cursor:pointer;
  font-size:16px;
  opacity:0.6;
  transition:opacity .2s,transform .1s,color .2s;
  user-select:none;
  color:#1db954;
}
.copy-btn:hover{opacity:1;color:#1ed760;transform:scale(1.1)}
.copy-btn:active{transform:scale(0.95)}

/* PROGRESS */
.progress{
  display:flex;gap:10px;align-items:center;
  font-size:11px;
  color:var(--text-muted);
  margin:8px 0 10px;
}
.progress span{
  min-width:36px;
  font-variant-numeric:tabular-nums;
  font-family:monospace;
  font-weight:600;
  color:var(--text-secondary);
}
.progress input{
  flex:1;
  height:6px;
  -webkit-appearance:none;
  background:rgba(255,255,255,.15);
  border-radius:3px;
  outline:none;
  cursor:pointer;
  transition:background .2s;
}

.progress input:hover{
  background:rgba(255,255,255,.25);
}

.progress input::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:14px;height:14px;
  background:#fff;
  border-radius:50%;
  cursor:pointer;
  opacity:0;
  transition:opacity .2s,box-shadow .2s;
  box-shadow:0 2px 8px rgba(0,0,0,.3);
}
.progress input:hover::-webkit-slider-thumb{
  opacity:1;
  box-shadow:0 4px 12px rgba(29,185,84,.5);
}
.progress input::-moz-range-thumb{
  width:14px;height:14px;
  background:#fff;
  border:none;
  border-radius:50%;
  cursor:pointer;
  box-shadow:0 2px 8px rgba(0,0,0,.3);
}
.progress input::-webkit-slider-runnable-track{
  height:6px;
  background:linear-gradient(to right,var(--accent) 0%,var(--accent) var(--seek-progress,0%),rgba(255,255,255,.15) var(--seek-progress,0%));
  border-radius:3px;
}

/* CONTROLS */
.controls{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:24px;
  margin:12px 0 14px;
}
.controls span{
  cursor:pointer;
  font-size:28px;
  opacity:0.5;
  transition:opacity .2s,transform .1s,color .2s;
  user-select:none;
  display:flex;
  align-items:center;
  justify-content:center;
  width:44px;
  height:44px;
  border-radius:50%;
}
.controls span:hover{
  opacity:1;
  color:var(--accent);
  background:rgba(29,185,84,0.1);
}
.controls span:active{transform:scale(0.92)}

.play{
  width:64px;
  height:64px;
  border-radius:50%;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:28px;
  color:#000;
  cursor:pointer;
  transition:transform .1s,box-shadow .2s;
  box-shadow:0 8px 20px rgba(29,185,84,.4);
  user-select:none;
  font-weight:800;
}
.play:hover{
  transform:scale(1.08);
  box-shadow:0 12px 28px rgba(29,185,84,.6);
}
.play:active{transform:scale(1)}

/* VOLUME */
.volume{
  display:flex;gap:12px;
  font-size:14px;
  color:var(--text-secondary);
  align-items:center;
  margin:8px 0 12px;
  padding:10px;
  background:rgba(107,95,199,0.1);
  border-radius:10px;
  border:1px solid rgba(107,95,199,0.2);
}
.volume span{
  opacity:0.8;
  font-size:18px;
}
.volume input{
  flex:1;
  height:6px;
  -webkit-appearance:none;
  background:rgba(255,255,255,.15);
  border-radius:3px;
  outline:none;
  cursor:pointer;
}
.volume input::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:14px;height:14px;
  background:#fff;
  border-radius:50%;
  cursor:pointer;
  opacity:0;
  transition:opacity .2s;
}
.volume input:hover::-webkit-slider-thumb{opacity:1}
.volume input::-moz-range-thumb{
  width:14px;height:14px;
  background:#fff;
  border:none;
  border-radius:50%;
  cursor:pointer;
}

/* ACTIONS */
.actions{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:8px;
  margin-top:6px;
}
.actions button{
  background:linear-gradient(135deg,rgba(255,255,255,0.08),rgba(255,255,255,0.03));
  border:1px solid rgba(255,255,255,.12);
  color:#fff;
  padding:14px 8px;
  border-radius:12px;
  font-weight:700;
  font-size:20px;
  cursor:pointer;
  transition:all .3s;
  opacity:0.6;
  backdrop-filter:blur(4px);
}
.actions button:hover{
  background:linear-gradient(135deg,rgba(255,255,255,0.15),rgba(255,255,255,0.08));
  opacity:0.9;
  border-color:rgba(255,255,255,.2);
}
.actions button:active{transform:scale(0.94)}
.actions button.active{
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  border-color:var(--accent);
  color:#000;
  opacity:1;
  box-shadow:0 4px 12px rgba(29,185,84,.4);
}

/* POPUP */
.popup{
  position:fixed;inset:0;
  background:rgba(0,0,0,.85);
  backdrop-filter:blur(8px);
  display:none;
  z-index:20;
  animation:fadeIn .2s;
}
@keyframes fadeIn{from{opacity:0;backdrop-filter:blur(0px)}to{opacity:1;backdrop-filter:blur(8px)}}

/* SHEET */
.sheet{
  position:absolute;bottom:0;left:50%;
  transform:translateX(-50%);
  width:100%;max-width:420px;
  max-height:75dvh;
  background:linear-gradient(180deg,var(--card) 0%,var(--bg-gradient) 100%);
  border-radius:16px 16px 0 0;
  padding:24px 16px 20px;
  overflow-y:auto;
  animation:slideUp .3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow:0 -8px 32px rgba(0,0,0,.6);
  border-top:1px solid rgba(255,255,255,.1);
}
@keyframes slideUp{from{transform:translate(-50%,100%)}to{transform:translate(-50%,0)}}

.sheet::-webkit-scrollbar{width:8px}
.sheet::-webkit-scrollbar-track{background:transparent}
.sheet::-webkit-scrollbar-thumb{background:rgba(29,185,84,.3);border-radius:4px}
.sheet::-webkit-scrollbar-thumb:hover{background:rgba(29,185,84,.5)}

/* CLOSE */
.close{
  position:absolute;top:16px;right:20px;
  font-size:24px;
  cursor:pointer;
  color:var(--text-muted);
  transition:color .2s,transform .1s;
  user-select:none;
  z-index:1;
}
.close:hover{color:#fff;transform:rotate(90deg)}

/* FORM */
.form h3{
  text-align:center;
  margin:0 0 24px;
  font-size:22px;
  font-weight:800;
  background:linear-gradient(135deg,#fff 0%,#b3b3b3 100%);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
.form input{
  width:100%;
  padding:14px 16px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.07);
  color:#fff;
  margin-bottom:14px;
  font-size:14px;
  transition:all .3s;
  font-weight:500;
}
.form input:focus{
  outline:none;
  border-color:var(--accent);
  background:rgba(255,255,255,.12);
  box-shadow:0 0 12px rgba(29,185,84,.3);
}
.form input::placeholder{color:var(--text-muted)}
.form button{
  width:100%;
  padding:16px;
  border:none;
  border-radius:10px;
  font-weight:700;
  font-size:15px;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#000;
  cursor:pointer;
  transition:all .2s;
  margin-top:10px;
  box-shadow:0 4px 12px rgba(29,185,84,.3);
}
.form button:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 20px rgba(29,185,84,.5);
}
.form button:active{transform:translateY(0)}

/* SONG CARD */
.song{
  display:flex;
  align-items:center;
  gap:12px;
  background:linear-gradient(135deg,rgba(255,255,255,0.05),rgba(255,255,255,0.02));
  border-radius:10px;
  padding:10px 12px;
  margin-bottom:8px;
  cursor:pointer;
  transition:all .2s;
  border:1px solid rgba(255,255,255,.08);
  backdrop-filter:blur(4px);
}
.song:hover{
  background:linear-gradient(135deg,rgba(29,185,84,0.15),rgba(107,95,199,0.1));
  border-color:rgba(29,185,84,.3);
  transform:translateX(4px);
}
.thumb{
  width:48px;
  height:48px;
  border-radius:8px;
  background:linear-gradient(135deg,var(--card),var(--card2));
  flex-shrink:0;
  box-shadow:0 4px 12px rgba(0,0,0,.3);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  color:var(--accent);
}
.song-meta{
  flex:1;
  min-width:0;
  cursor:pointer;
}
.song-title{
  font-size:14px;
  font-weight:700;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  margin-bottom:2px;
  color:#fff;
}
.song-by{
  font-size:12px;
  color:var(--text-muted);
}
.song-dur{
  font-size:11px;
  color:var(--text-muted);
  margin-right:8px;
  font-variant-numeric:tabular-nums;
  font-weight:600;
}
.fav-btn{
  cursor:pointer;
  font-size:20px;
  opacity:0.4;
  transition:opacity .2s,transform .1s,color .2s;
  user-select:none;
}
.fav-btn:hover{opacity:0.7}
.fav-btn.active{
  color:var(--secondary);
  opacity:1;
  animation:pulse .3s;
}
.fav-btn:active{transform:scale(0.85)}

@keyframes pulse{
  0%{transform:scale(1)}
  50%{transform:scale(1.2)}
  100%{transform:scale(1)}
}
</style>
</head>

<body>

<div class="bg"></div>

<div class="app">
  <div class="header">
    <img src="exemusic.png" alt="ExeMusic Logo">
  </div>
  <div class="version">v1.0.2</div>

  <div class="cover">
    <div class="eq"><span></span><span></span><span></span></div>
  </div>

  <div class="title" id="title">Loading‚Ä¶</div>
  <div class="by" id="by"></div>

  <div class="url-wrap">
    <div class="url" id="url"></div>
    <div class="copy-btn" onclick="copyURL()" title="Copy URL">üìã</div>
  </div>

  <div class="progress">
    <span id="cur">0:00</span>
    <input type="range" id="seek" min="0" max="100" value="0">
    <span id="dur">0:00</span>
  </div>

  <div class="controls">
    <span onclick="prev()" title="Previous">‚èÆ</span>
    <div class="play" id="play" onclick="toggle()" title="Play/Pause">‚ñ∂</div>
    <span onclick="next()" title="Next">‚è≠</span>
  </div>

  <div class="volume">
    <span id="volIcon">üîä</span>
    <input type="range" id="vol" min="0" max="1" step="0.01" value="0.6">
  </div>

  <div class="actions">
    <button onclick="toggleRepeat()" id="rep" title="Repeat">üîÅ</button>
    <button onclick="openList(false)" title="All Songs">‚ò∞</button>
    <button onclick="openList(true)" title="Favorites">‚òÖ</button>
    <button onclick="openReq()" title="Request Song">‚ûï</button>
  </div>
</div>

<!-- POPUP LIST -->
<div class="popup" id="popup">
  <div class="sheet" id="sheet"></div>
</div>

<!-- POPUP REQUEST -->
<div class="popup" id="reqPopup">
  <div class="sheet">
    <div class="close" onclick="closeReq()">‚úï</div>
    <div class="form">
      <h3>Add Your Owned Music Request</h3>
      <input id="rNama" placeholder="Nama" autocomplete="off">
      <input id="rUrl" placeholder="URL" autocomplete="off">
      <input id="rLagu" placeholder="Nama Lagu" autocomplete="off">
      <button onclick="sendReq()">Kirim ke WhatsApp</button>
    </div>
  </div>
</div>

<script>
let songs=[],i=0,repeat=false;
let fav=JSON.parse(localStorage.getItem("exeFav")||"[]");
const audio=new Audio();
const eq=document.querySelectorAll(".eq span");

/* LOAD DATA */
fetch("data/urlbb.json").then(r=>r.json()).then(d=>{
  songs=d;
  preloadDurations();
  if(songs.length>0)load(0);
}).catch(err=>{
  title.textContent="Error loading songs";
  by.textContent="Check console for details";
  console.error(err);
});

function preloadDurations(){
  songs.forEach((s,idx)=>{
    const a=new Audio();
    a.src=s.url;
    a.onloadedmetadata=()=>songs[idx].duration=format(a.duration);
  });
}

function load(n){
  if(!songs[n])return;
  i=n;
  audio.src=songs[n].url;
  title.textContent=songs[n].title;
  by.textContent="request by "+songs[n].by;
  url.textContent=songs[n].url;
  audio.play();
  play.textContent="‚ùö‚ùö";
  eq.forEach(e=>e.style.animationPlayState="running");
}

function toggle(){
  if(audio.paused){
    audio.play();
    play.textContent="‚ùö‚ùö";
    eq.forEach(e=>e.style.animationPlayState="running");
  }else{
    audio.pause();
    play.textContent="‚ñ∂";
    eq.forEach(e=>e.style.animationPlayState="paused");
  }
}

function prev(){
  if(songs.length>0)load((i-1+songs.length)%songs.length);
}

function next(){
  if(songs.length>0)load((i+1)%songs.length);
}

audio.onloadedmetadata=()=>{
  seek.max=audio.duration;
  dur.textContent=format(audio.duration);
};

audio.ontimeupdate=()=>{
  seek.value=audio.currentTime;
  cur.textContent=format(audio.currentTime);
  // Update progress bar visual
  const progress=(audio.currentTime/audio.duration)*100||0;
  seek.style.setProperty('--seek-progress',progress+'%');
};

seek.oninput=()=>audio.currentTime=seek.value;

vol.oninput=e=>{
  audio.volume=e.target.value;
  volIcon.textContent=e.target.value==0?"üîá":e.target.value<0.6?"üîâ":"üîä";
};

function toggleRepeat(){
  repeat=!repeat;
  rep.classList.toggle("active",repeat);
}

audio.onended=()=>repeat?audio.play():next();

function copyURL(){
  const t=url.textContent;
  if(navigator.clipboard){
    navigator.clipboard.writeText(t).then(()=>{
      const orig=document.querySelector('.copy-btn').textContent;
      document.querySelector('.copy-btn').textContent='‚úì';
      setTimeout(()=>document.querySelector('.copy-btn').textContent=orig,1000);
    });
  }else{
    const a=document.createElement("textarea");
    a.value=t;
    document.body.appendChild(a);
    a.select();
    document.execCommand("copy");
    document.body.removeChild(a);
  }
}

function openList(favOnly){
  popup.style.display="block";
  sheet.innerHTML='<div class="close" onclick="popup.style.display=\'none\'">‚úï</div>';
  
  const filteredSongs=favOnly?songs.filter(s=>fav.includes(s.url)):songs;
  
  if(filteredSongs.length===0){
    sheet.innerHTML+='<p style="text-align:center;color:var(--muted);margin-top:40px;">Belum ada lagu favorit</p>';
    return;
  }
  
  filteredSongs.forEach((s,n)=>{
    const actualIndex=songs.indexOf(s);
    sheet.innerHTML+=`
    <div class="song">
      <div class="thumb"></div>
      <div class="song-meta" onclick="load(${actualIndex});popup.style.display='none'">
        <div class="song-title">${s.title}</div>
        <div class="song-by">${s.by}</div>
      </div>
      <div class="song-dur">${s.duration||"0:00"}</div>
      <div class="fav-btn ${fav.includes(s.url)?"active":""}"
           onclick="toggleFav('${s.url}',event)">‚òÖ</div>
    </div>`;
  });
}

function toggleFav(u,e){
  e.stopPropagation();
  fav=fav.includes(u)?fav.filter(x=>x!==u):[...fav,u];
  localStorage.setItem("exeFav",JSON.stringify(fav));
  // Refresh the current list view
  const isFavView=document.querySelectorAll('.song').length<songs.length;
  openList(isFavView);
}

popup.onclick=e=>{if(e.target===popup)popup.style.display="none"};
reqPopup.onclick=e=>{if(e.target===reqPopup)closeReq()};

function openReq(){reqPopup.style.display="block"}
function closeReq(){
  reqPopup.style.display="none";
  rNama.value='';
  rUrl.value='';
  rLagu.value='';
}

function sendReq(){
  if(!rNama.value||!rUrl.value||!rLagu.value){
    alert('Mohon isi semua field');
    return;
  }
  const text=`Format Req Lagu

Nama : ${rNama.value}
Url : ${rUrl.value}
Nama Lagu : ${rLagu.value}`;
  window.open(
    "https://wa.me/62895329018240?text="+encodeURIComponent(text),
    "_blank"
  );
  closeReq();
}

function format(t){
  if(isNaN(t))return"0:00";
  return Math.floor(t/60)+":"+String(Math.floor(t%60)).padStart(2,"0");
}
</script>

</body>
</html>
